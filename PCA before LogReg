# Python, IPython, anaconda

import numpy as np
import pandas as pd
from sklearn.cross_validation import train_test_split

# Data Import
df = pd.read_csv("data.csv")

 # Drop NaN
data = df.dropna()

data_np = data.values
X = data_np[:, 1:].astype(np.float64)
y = data_np[:, 0].astype(np.int64)

# PCA(dim 21 -> 5)
from sklearn.decomposition import PCA
pca = PCA(n_components=5)
pca.fit(X)

# Transform PCA
X_r = pca.fit(X).transform(X)

# Data Split
X_train, X_test, y_train, y_test = train_test_split(X_r, y, train_size=0.3)

# Import Logistic Regression
from sklearn.linear_model import LogisticRegression

model = LogisticRegression()

# model fit
model.fit(X_train, y_train)

# accuracy
model.score(X_test, y_test)

#  Logit Regression Result
import statsmodels.api as sm

y_pred = model.predict(X_test)

reg = sm.Logit(y_pred, X_test)

f = reg.fit()

f.summary()
